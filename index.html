<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KTU Tools - CGPA & Attendance (ECE 2019)</title>
<style>
  body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f9f9f9; color:#333; }
  header { background:#004080; color:white; text-align:center; padding:15px; }
  .container { max-width:900px; margin:20px auto; padding:20px; background:white; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
  h2 { color:#004080; margin-top:0; }
  .input-group { margin:10px 0; }
  label { display:block; margin-bottom:5px; font-weight:bold; }
  input, select { width:100%; padding:10px; font-size:16px; border:1px solid #ccc; border-radius:6px; box-sizing:border-box; }
  .btn { margin-top:10px; padding:10px 20px; font-size:16px; background:#004080; color:white; border:none; border-radius:6px; cursor:pointer; }
  .btn:hover { background:#003060; }
  .result { margin-top:10px; padding:10px; background:#f0f8ff; border-left:4px solid #004080; white-space:pre-line; }
  .subject-row { display:flex; gap:10px; margin-bottom:5px; }
  .subject-row span { flex:2; align-self:center; }
  .subject-row select { flex:1; }
  @media (max-width:600px){
    .subject-row { flex-direction:column; }
    .subject-row span, .subject-row select { width:100%; }
  }
</style>
</head>
<body>

<header>
  <h1>KTU ECE 2019 - CGPA & Attendance Calculator</h1>
</header>

<div class="container" id="cgpaCalculator">
  <h2>CGPA Calculator (ECE 2019 Scheme)</h2>
  <div id="semesters"></div>
  <button class="btn" onclick="shareResult()">Share Result</button>
  <div class="result" id="cgpaResult"></div>
  <div id="shareMsg" style="margin-top:5px;color:green;font-weight:bold;"></div>
</div>

<div class="container" id="attendanceCalculator">
  <h2>Attendance Calculator</h2>
  <div class="input-group">
    <label>Classes Attended</label>
    <input type="number" id="attended" placeholder="Enter attended classes">
  </div>
  <div class="input-group">
    <label>Total Classes</label>
    <input type="number" id="total" placeholder="Enter total classes">
  </div>
  <div class="input-group">
    <label>Target %</label>
    <select id="target">
      <option value="75">75%</option>
      <option value="80">80%</option>
      <option value="85">85%</option>
      <option value="90">90%</option>
      <option value="95">95%</option>
    </select>
  </div>
  <button class="btn" onclick="calcAttendance()">Calculate Attendance</button>
  <div class="result" id="attendanceResult"></div>
</div>

<script>
// ===== Grading Map =====
const gradeMap = { 'S':10, 'A':9, 'B':8, 'C':7, 'D':6, 'E':5, 'F':0 };

// ===== ECE 2019 Scheme Subjects =====
const ece2019 = {
  "Semester 3":[
    {name:"MAT 201 – PDE & Complex Analysis", credit:4},
    {name:"ECT 201 – Solid State Devices", credit:4},
    {name:"ECT 203 – Logic Circuit Design", credit:4},
    {name:"ECT 205 – Network Theory", credit:4},
    {name:"EST 200 – Design and Engineering", credit:2},
    {name:"HUT 200 – Professional Ethics", credit:2},
    {name:"MCN 201 – Sustainable Engineering", credit:0},
    {name:"ECL 201 – Scientific Computing Lab", credit:2},
    {name:"ECL 203 – Logic Design Lab", credit:2}
  ]
  // ⚡ Add Semester 1–8 here (same structure) when needed
};

// ===== Render Semesters =====
function renderSemesters(){
  let container = document.getElementById('semesters');
  container.innerHTML = '';
  Object.keys(ece2019).forEach((sem, idx)=>{
    let div = document.createElement('div');
    div.innerHTML = `<h3>${sem}</h3>`;
    ece2019[sem].forEach((sub,j)=>{
      let row = document.createElement('div');
      row.className='subject-row';
      row.innerHTML=`
        <span>${sub.name} (${sub.credit}cr)</span>
        <select onchange="calcSGPA('${sem}')">
          <option value="">Grade</option>
          <option>S</option><option>A</option><option>B</option>
          <option>C</option><option>D</option><option>E</option><option>F</option>
        </select>`;
      div.appendChild(row);
    });
    div.innerHTML += `<div class="result" id="${sem}_sgpa">SGPA: -</div>`;
    container.appendChild(div);
  });
}
renderSemesters();

// ===== Calculate SGPA per semester & CGPA =====
function calcSGPA(sem){
  let rows = document.querySelectorAll(`#semesters h3:contains('${sem}') ~ .subject-row`);
}
function calcAll(){
  let totalPoints=0, totalCredits=0;
  let output='';
  Object.keys(ece2019).forEach(sem=>{
    let semDiv = document.querySelector(`#semesters h3:contains('${sem}')`).parentNode;
    let selects = semDiv.querySelectorAll('select');
    let points=0, credits=0;
    selects.forEach((sel,i)=>{
      let grade=sel.value;
      let credit=ece2019[sem][i].credit;
      if(grade && credit>0){
        points+=gradeMap[grade]*credit;
        credits+=credit;
      }
    });
    if(credits>0){
      let sgpa=(points/credits).toFixed(2);
      semDiv.querySelector(`#${sem}_sgpa`).innerText=`SGPA: ${sgpa}`;
      totalPoints+=points;
      totalCredits+=credits;
      output+=`${sem} SGPA: ${sgpa}\n`;
    }
  });
  if(totalCredits>0){
    let cgpa=(totalPoints/totalCredits).toFixed(2);
    document.getElementById('cgpaResult').innerText=`Overall CGPA: ${cgpa}`;
    return output+`Overall CGPA: ${cgpa}`;
  } else {
    document.getElementById('cgpaResult').innerText='Fill in grades to calculate CGPA';
    return '';
  }
}

// ===== Share Result =====
function shareResult(){
  let text = calcAll();
  if(!text){ alert("Please fill some grades first."); return; }
  navigator.clipboard.writeText(text).then(()=>{
    document.getElementById('shareMsg').innerText="Result copied to clipboard. You can paste and share it.";
  });
}

// ===== Attendance Calculator =====
function calcAttendance(){
  let attended=parseInt(document.getElementById('attended').value);
  let total=parseInt(document.getElementById('total').value);
  let target=parseInt(document.getElementById('target').value);
  if(isNaN(attended)||isNaN(total)||total<=0){ alert("Enter valid numbers"); return; }
  let percent=(attended/total*100).toFixed(2);
  let result=`Current Attendance: ${percent}%\n`;
  if(percent>=target){
    let maxBunk = Math.floor((attended*100/target)-total);
    if(maxBunk<0) maxBunk=0;
    result+=`✅ Safe. You can cut ${maxBunk} more classes.`;
  } else {
    let need=Math.ceil((target*total - attended*100)/(100-target));
    result+=`⚠️ Below target. You must attend next ${need} classes.`;
  }
  document.getElementById('attendanceResult').innerText=result;
}
</script>

</body>
</html>
